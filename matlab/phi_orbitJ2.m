% 考虑J2项的位置速度轨道动力方程的状态转移矩阵
function PHI = phi_orbitJ2(s,step)
J2 = 0.00108262668355315;
GEarth = 398600.4418;
Re = 6378.137;
x = s(1);
y = s(2);
z = s(3);
r = sqrt(x^2+y^2+z^2);
xr = x/r;
yr = y/r;
zr = z/r;
ur3 = GEarth/r^3;
rr2j2 = J2*(Re/r)^2;
D = [zeros(3,3) eye(3);zeros(3,6)];
D(4,1) = -ur3*( (1-3*xr^2) + rr2j2*( 1.5*(1-5*zr^2) - 7.5*xr^2*(1-7*zr^2) ) );
D(4,2) = ur3*xr*yr*(3+7.5*rr2j2*(1-7*zr^2));
D(4,3) = ur3*xr*zr*(3+7.5*rr2j2*(1-7*zr^2));
D(5,1) = D(4,2);
D(5,2) = -ur3*( (1-3*yr^2) + rr2j2*( 1.5*(1-5*zr^2) - 7.5*yr^2*(1-7*zr^2) ) );
D(5,3) = ur3*yr*zr*(3+7.5*rr2j2*(3-7*zr^2));
D(6,1) = D(4,3);
D(6,2) = D(5,3);
D(6,3) = -ur3*( (1-3*zr^2) + 1.5*rr2j2*(35*zr^4-30*zr^2+3) );
PHI = eye(6) + D*step + 0.5*D^2*step^2;